<!doctype html>
<html>
  <head>
    <title>BTC vs USD$</title>

    <meta name="viewport" content="width=device-width">
    <link href="http://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700,800" rel="stylesheet" type="text/css">

    <style>
      body {
        font-family: 'Open Sans', 'Helvetica Neue', Helvetica, Arial, sans-serif;
        width: 80%;
        margin: 0 auto;
      }

      div#lasttick {
        width: 100%;
        font-weight: bold;
        font-size: 40pt;
        text-align: center;
      }

      ul#ticks {
        columns: 100px 3;
        -webkit-columns: 100px 3;
        -moz-columns: 100px 3;
      }

      ul#ticks li {
        list-style-type: none;
      }
    </style>
  </head>
  <body>
    <div id="lasttick">
    </div>
    <ul id="ticks">
    </ul>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.0/jquery.min.js"></script>
    <script src="/socket.io/socket.io.js"></script>
    <script>
      var socket = io.connect(window.location);
      socket.on('tick', function (data) {
        // update the DOM -- keep last 100 ticks
        var template = '1 BTC = USD $<span></span>';
        var prevTick = parseFloat($('#lasttick span').text().substring(1));
        var currTick = parseFloat(data.v);
        $('ul#ticks').prepend('<li>' + $('#lasttick').html() + '</li>');
        $('#lasttick').html('1 BTC = USD <span>$' + data.v + '</span>');
        var tickColor = 'black';
        if (prevTick) {
          if (currTick > prevTick) {
            tickColor = 'green';
          } else if (currTick < prevTick) {
            tickColor = 'red';
          }
        }
        $('#lasttick span').css('color', tickColor);
        $('ul#ticks li:first').html();
        $('ul#ticks li:gt(' + 98 + ')').remove();
      });
    </script>
  </body>
</html>
